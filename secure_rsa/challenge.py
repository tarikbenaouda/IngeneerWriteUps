from Crypto.Util.number import bytes_to_long as bl ,long_to_bytes as lb ,getPrime, isPrime
from random import randint 

FLAG = b'this is a fake flag'
def getsecondparameter(num):
    while True :
        num += randint(1,getPrime(128))
        if isPrime(num):
            return num 


p = getPrime(2048)
print(p)
q = getsecondparameter(p)

n = p*q 
e = 0x10001
d= pow(e,-1,(p-1)*(q-1))
ct = pow(bl(FLAG) , e , n)
ct = '576020107131010091149011838295565022168093672248025902084601827846846206130018546405136198445862114398756830314883862112320813851642713574685741799407530102268950191809287426251835433368861650798572826146565681055643844593458697497840631286831190310201425453521285770860645542259265893192176175660990003263651982753394251661926028314530054942312498453002440165302868583917307368041814963139477451963757779169549990193018365571449706409814012781911893693859313020362964692640782517362883351371246973758567975864381884324697956106367724105520746907966572407224057402236028311823610524385362676401228015002330047571942679859865197239777348871360253391812940329457448631174216624199978827874530547189806242392657300045576106770107028838648982528578827199046277184563544117565526402113835478697093038220629484196955015002480876231696410615499397806601188325523796165038595960246136356874369676805741489091750541573516887377533188231241405767974192643347602138817386165160568776460387017010640819210631373800711681878962024456200480955116569549673918820510046790724513324789348576166657134871837576180750038298164892544703465165845025574271209025234224122241242393939346230706825188050749147940555487230829750464756375225587330361515274707'
ct = int(ct)
pt = pow(ct,d,n)
print(lb(pt))
# with open('fake.txt', 'w') as f :
#     f.write('ct : {}\n'.format(ct))
#     f.write('e : {}\n'.format(e))
#     f.write('n : {}\n'.format(n))
